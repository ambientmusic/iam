<!doctype html>
<html>
  <head>
    <title>Melody | Harmony | Rhythm</title>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <style type="text/css">

      *:focus {
       outline: none;
      }
      #login, #loggedin, {
        display: none;
      }
      .text-overflow {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        width: 500px;
      }

    </style>
  </head>

  <body style="background-color:white;"><br>
    <div class="container">

    <div width="50%"; style="float:right;padding-top:57px;"><img src="img/13.jpg" width="130" height="131" ></img><img src="img/2.jpg" width="130" height="131" ></img><img src="img/3.jpg" width="130" height="131" ></img><img src="img/4.jpg" width="130" height="131" ></img><br><img src="img/5.jpg" width="130" height="131" ></img><img src="img/6.jpg" width="130" height="131" ></img><img src="img/7.jpg" width="130" height="131" ></img><img src="img/8.jpg" width="130" height="131" ><br></img><img src="img/9.jpg" width="130" height="131" ></img><img src="img/10.jpg" width="130" height="131" ></img><img src="img/11.jpg" width="130" height="131" ></img><img src="img/12.jpg" width="130" height="131" ><br></img><img src="img/1.jpg" width="130" height="131" ></img><img src="img/14.jpg" width="130" height="131" ></img><img src="img/15.jpg" width="130" height="131" ></img><img src="img/16.jpg" width="130" height="131" ></img></div>

      <div id="login">
        <h1 style="margin-top:15px">Ambient Music International</h1>
      <textarea  autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="resize: none;border:0;background:white;text-align:justify;height:585px; width:590px;">For all the good that technology has brought into our lives, one of the downsides is the inability to make meaningful connections with the music made available to the community as a whole. &#013;&#010;&#013;&#010;The difficulty in selecting good songs from a multitude of, at best, sketchily filtered tracks exacerbated by market-driven forces limited by youthful tastes, does little to resolve this problem.&#013;&#010;&#013;&#010;AMI offers quick access to pre-selected playlists made up of the best songs on offer by world-renowned (and some not so well known) musicians.&#013;&#010;&#013;&#010;This website is free to Spotify premium users and conveniently presents an option for you (and your clients) to experience a wide range of tasteful international music. Our growing array of synchronised, multi-language lyrics and related artist information might also interest you. &#013;&#010;&#013;&#010;Why not seize the opportunity to encourage new customers (perhaps even successful grown-ups) to join you for a few drinks during quieter times, say, early evening when others are pre-loading or have dispersed from their seats of learning to all corners of the country?  &#013;&#010;&#013;&#010;If you choose to take a closer look, we will ask for permission to access some of your Spotify data. This data is limited to Your Public Playlists, The Type of Device You're Listening On and The Track You're Playing. However, we only use the latter and permission can easily be reversed by you at any time. &#013;&#010;&#013;&#010;We aim to help local businesses break out of the status quo and improve their customer service; at least give us a try.</textarea><a href="/login" class="btn btn-primary" style="margin-left:420px;margin-top:-165px;">Connect AMI to Spotify</a>
</div>
</div>


    <script id="user-profile-template" type="text/x-handlebars-template">
      <h1>Logged in as {{display_name}}</h1>
      <div class="media">
        <div class="pull-left">
          <img class="media-object" width="150" src="{{images.0.url}}" />
        </div>
        <div class="media-body">
          <dl class="dl-horizontal">
            <dt>Display name</dt><dd class="clearfix">{{display_name}}</dd>
            <dt>Id</dt><dd>{{id}}</dd>
            <dt>Email</dt><dd>{{email}}</dd>
            <dt>Spotify URI</dt><dd><a href="{{external_urls.spotify}}">{{external_urls.spotify}}</a></dd>
            <dt>Link</dt><dd><a href="{{href}}">{{href}}</a></dd>
            <dt>Profile Image</dt><dd class="clearfix"><a href="{{images.0.url}}">{{images.0.url}}</a></dd>
            <dt>Country</dt><dd>{{country}}</dd>
          </dl>
        </div>
      </div>
    </script>

    <script id="oauth-template" type="text/x-handlebars-template">
      <h2>oAuth info</h2>
      <dl class="dl-horizontal">
        <dt>Access token</dt><dd class="text-overflow">{{access_token}}</dd>
        <dt>Refresh token</dt><dd class="text-overflow">{{refresh_token}}</dd>
      </dl>
    </script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0-alpha.1/handlebars.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script>
      (function() {

        /**
         * Obtains parameters from the hash of the URL
         * @return Object
         */
        function getHashParams() {

          var hashParams = {};
          var e, r = /([^&;=]+)=?([^&;]*)/g,
              q = window.location.hash.substring(1);
          while ( e = r.exec(q)) {
             hashParams[e[1]] = decodeURIComponent(e[2]);
          }
          return hashParams;
        }

        var userProfileSource = document.getElementById('user-profile-template').innerHTML,
            userProfileTemplate = Handlebars.compile(userProfileSource),
            userProfilePlaceholder = document.getElementById('user-profile');

        var oauthSource = document.getElementById('oauth-template').innerHTML,
            oauthTemplate = Handlebars.compile(oauthSource),
            oauthPlaceholder = document.getElementById('oauth');

        var params = getHashParams();


        var access_token = params.access_token,

            refresh_token = params.refresh_token,
            error = params.error;

        if (error) {
          alert('There was an error during the authentication');
        } else {
          if (access_token) {
            // render oauth info
            oauthPlaceholder.innerHTML = oauthTemplate({
              access_token: access_token,
              refresh_token: refresh_token

            });

            $.ajax({
                url: 'https://api.spotify.com/v1/me',
                headers: {
                  'Authorization': 'Bearer ' + access_token
                },
                success: function(response) {
                  userProfilePlaceholder.innerHTML = userProfileTemplate(response);

                  $('#login').hide();
                  $('#loggedin').show();
                }
            });
          } else {
              // render initial screen
              $('#login').show();
              $('#loggedin').hide();
          }

          document.getElementById('obtain-new-token').addEventListener('click', function() {
            $.ajax({
              url: '/refresh_token',
              data: {
                'refresh_token': refresh_token
              }
            }).done(function(data) {
              access_token = data.access_token;
              oauthPlaceholder.innerHTML = oauthTemplate({
                access_token: access_token,
                refresh_token: refresh_token

              });
            });
          }, false);
        }
      })();

  </script>

<link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
<!------ Include the above in your HEAD tag ---------->

  </body>
</html>

